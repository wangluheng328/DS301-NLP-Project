During a softball game at an American oil company housing compound in Riyadh, Saudi Arabia, al-Qaeda terrorists set off a bomb, killing Americans and Saudis.
While one team hijacks a car and shoots residents, a suicide bomber blows himself up, killing everyone near him.
Sergeant Haytham (Ali Suliman), of the Saudi State Police, disables a stolen Saudi Police vehicle and kills the terrorists in it.
The FBI Legal Attach√© in Saudi Arabia, Special Agent Fran Manner (Kyle Chandler), calls his US colleague, Special Agent Ronald Fleury (Jamie Foxx), to advise him about the attack.
Manner is discussing with DSS Regional Security Officer Special Agent Rex Bura how to secure the crime scene when a second bomb explodes in the compound, killing Manner, Bura and many others.

At FBI Headquarters in Washington, D.C., Fleury briefs his rapid deployment team on the attack.
During the briefing, Fleury whispered to Mayes to calm her down when she knew the death of Manner.
Although the U.S. Justice Department and the U.S. State Department hinder FBI efforts to investigate the attack, Fleury blackmails the Saudi ambassador into allowing an FBI investigative team into Saudi Arabia.
Fleury and Special Agent Janet Mayes (Jennifer Garner), a forensic examiner, Adam Leavitt (Jason Bateman), an intelligence analyst, and Special Agent Grant Sykes (Chris Cooper), a bomb technician, go to Saudi Arabia.
On arrival they are met by Colonel Faris al-Ghazi (Ashraf Barhom), the commander of the Saudi State Police Force providing security at the compound.
The investigation is being run by General Al Abdulmalik (Mahmoud Said) of the Saudi National Guard, who does not give Fleury and his team permission to investigate but only to observe the Saudi investigation.

The FBI team is invited to the palace of Saudi Prince Ahmed bin Khaled (Omar Berdouni) for a dinner.
While at the palace, Fleury persuades the Prince that Colonel al-Ghazi is a natural detective and should be allowed to lead the investigation.
With this change in leadership, the Americans are allowed hands-on access to the crime scene.
While searching for evidence, Sergeant Haytham and Sykes discover the second bomb was detonated in an ambulance.
Fleury learns the brother of one of the dead terrorists had access to ambulances and police uniforms.
Colonel al-Ghazi orders a SWAT team to raid a house, managing to kill a few heavily armed terrorists.
Following the raid, the team discovers valuable clues, including photos of the U.S. and other Western embassies in Riyadh.
Soon afterward, the U.S. Embassy Deputy Chief of Mission Damon Schmidt (Jeremy Piven) notifies Fleury and his team that they have been ordered to return to the United States.

On their way to King Khalid International Airport, Fleury grabs the wheel from Sergeant Haytham, which allows them to partially evade the collision of a speeding car with the first SUV in their convoy, setting off a trunk full of explosives.
Their SUV, the third in their convoy, hits the first SUV.
The fourth SUV drives up and the men inside pull out Leavitt, throwing him into the back and driving away while a second car drives by to shoot the surviving Americans.
Fleury manages to wound one attacker, and al-Ghazi commandeers a civilian vehicle to chase the fourth SUV and the other car into the dangerous Al-Suwaidi neighborhood of Riyadh.
As they pull up, a gunman launches rocket-propelled grenades at them and a fierce firefight starts.
Inside the complex, Leavitt is tied up and gagged.

While Sykes and Haytham watch the entrance to the complex, al-Ghazi, Fleury, and Mayes follow a blood trail and manage to kill many gunmen inside.
Mayes, separated from the others, enters an apartment to find a family with little children, their mother, and grandfather.
She yells at them to stay put and goes across the hall to another apartment, where she finds Leavitt and his attackers.
She kills the remaining insurgents, and al-Ghazi and the team start to leave.
Mayes give the little girl a lollipop.
In return, the girl gives her a marble, matching those pieced together earlier from the bomb scene.
Fleury then realizes there is a trail of blood leading to the back of the apartment, and al-Ghazi sees the grandfather, suspects something, and asks to help him up in order to inspect his hand.
When the old man gives him his hand, al-Ghazi sees that the man is missing the same fingers as Abu Hamza al-Masri[3] in the terrorist group's many videos and confirms his suspicion that the grandfather is the terrorist leader.
Abu Hamza's teenage grandson walks out of the bedroom and manages to shoot al-Ghazi in the neck twice with a pistol before it jams, then he starts to point his gun at Mayes, prompting Fleury to kill him.
Abu Hamza then feebly pulls out an assault rifle and Haytham puts three shots in his chest.
As Abu Hamza dies, another grandson hugs him and Abu Hamza whispers something into his ear to calm the child down.
Al-Ghazi dies in Fleury's arms.

At al-Ghazi's house, Fleury and Haytham meet his family.
Fleury tells his son that al-Ghazi was his good friend, mirroring a similar scene earlier in the movie wherein he comforted Special Agent Manner's son.
Fleury and his team return to the U.S., where they are commended by FBI Director James Grace (Richard Jenkins) for their outstanding work.
Leavitt asked Fleury and Mayes what he had whispered to her to clam her down.
The scene cuts to Abu Hamza's daughter asking her own son what his grandfather whispered to him as he was dying.
The grandson tells her mother, "Don't fear them, my child.
We are going to kill them all".
This is almost the same as what Fleury whispered to Mayes.
Implying that this is a never-ending, vicious cycle.